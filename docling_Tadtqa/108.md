Differences between income taxes calculated using the statutory federal income tax rate of21% in the fiscal year endedJuly 31, 2019, 26.9% in the fiscal year ended July 31, 2018, and 35% in the fiscal year endedJuly 31, 2017 and the provision for income taxes are as follows (in thousands):

Table of Contents

|                                                 | Fiscal years ended July 31,   | Fiscal years ended July 31,   | Fiscal years ended July 31,   |
|-------------------------------------------------|-------------------------------|-------------------------------|-------------------------------|
|                                                 | 2019                          | 2018                          | 2017                          |
| Statutory federal income tax                    | $ 2,617                       | $ (2,224 )                    | $ 9,984                       |
| State taxes, net of federal benefit             | (939)                         | (993)                         | 806                           |
| Share-based compensation                        | (8,013 )                      | (8,715 )                      | 2,517                         |
| Non-deductible officers' compensation           | 3,938                         | 3,230                         | 959                           |
| Foreign income taxed at different rates         | 203                           | 1,022                         | (819 )                        |
| Research tax credits                            | (6,943)                       | (5,822)                       | (2,377)                       |
| Re-measurement of U.S. deferred taxes           | -                             | 36,125                        | -                             |
| Non-deductible acquisition costs                | -                             | 1,270                         | 270                           |
| Domestic production activity deduction          | -                             | -                             | (1,370 )                      |
| Permanent differences and others                | 918                           | 666                           | 484                           |
| Change in valuation allowance                   | (61 )                         | (6,092 )                      | -                             |
| Total provision for (benefit from) income taxes | $ (8,280)                     | $ 18,467                      | $ 10,454                      |

The tax effects of temporary differences that gave rise to significant portions of deferred tax assets and liabilities are as follows (in thousands):

|                                      | As of July 31,   | As of July 31,   |
|--------------------------------------|------------------|------------------|
|                                      | 2019             | 2018             |
| Accruals and reserves                | $ 7,870          | $ 12,129         |
| Stock-based compensation             | 6,353            | 7,658            |
| Deferred revenue                     | 2,316            | 4,023            |
| Property and equipment               | -                | 1,268            |
| Net operating loss carryforwards     | 55,881           | 56,668           |
| Tax credits                          | 74,819           | 60,450           |
| Total deferred tax assets            | 147,239          | 142,196          |
| Less valuation allowance             | 31,421           | 28,541           |
| Net deferred tax assets              | 115,818          | 113,655          |
| Less deferred tax liabilities:       |                  |                  |
| Intangible assets                    | 7,413            | 11,461           |
| Convertible debt                     | 10,274           | 11,567           |
| Property and equipment               | 1,435            | -                |
| Unremitted foreign earnings          | 302              | 258              |
| Capitalized commissions              | 6,086            | -                |
| Total deferred tax liabilities       | 25,510           | 23,286           |
| Deferred tax assets, net             | 90,308           | 90,369           |
| Less foreign deferred revenue        | -                | 69               |
| Less foreign capitalized commissions | 906              | -                |
| Total net deferred tax assets        | 89,402           | 90,300           |

The Company considered both positive and negative evidence, including future reversals of existing taxable temporary differences, projected future taxable income, tax planning strategies, historic book profit/loss, prior taxable income/loss, and results of future operations, and determined that a valuation allowance was not required for a significant portion of its deferred tax assets. A valuation allowance of $31.4 million and $28.5 million remained as of July 31, 2019 and 2018, respectively. The increase of $2.9 million in the valuation allowance in the current fiscal year relates primarily to net operating losses and income tax credits incurred in certain tax jurisdictions for which no tax benefit was recognized.